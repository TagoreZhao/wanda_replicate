Running with MPI and wanda pruning method on a single node with 4 GPUs
usage: torchrun
       [-h]
       [--nnodes NNODES]
       [--nproc_per_node NPROC_PER_NODE]
       [--rdzv_backend RDZV_BACKEND]
       [--rdzv_endpoint RDZV_ENDPOINT]
       [--rdzv_id RDZV_ID]
       [--rdzv_conf RDZV_CONF]
       [--standalone]
       [--max_restarts MAX_RESTARTS]
       [--monitor_interval MONITOR_INTERVAL]
       [--start_method {spawn,fork,forkserver}]
       [--role ROLE]
       [-m]
       [--no_python]
       [--run_path]
       [--log_dir LOG_DIR]
       [-r REDIRECTS]
       [-t TEE]
       [--node_rank NODE_RANK]
       [--master_addr MASTER_ADDR]
       [--master_port MASTER_PORT]
       training_script
       ...
torchrun: error: unrecognized arguments: --rdzv_timeout
usage: torchrun
       [-h]
       [--nnodes NNODES]
       [--nproc_per_node NPROC_PER_NODE]
       [--rdzv_backend RDZV_BACKEND]
       [--rdzv_endpoint RDZV_ENDPOINT]
       [--rdzv_id RDZV_ID]
       [--rdzv_conf RDZV_CONF]
       [--standalone]
       [--max_restarts MAX_RESTARTS]
       [--monitor_interval MONITOR_INTERVAL]
       [--start_method {spawn,fork,forkserver}]
       [--role ROLE]
       [-m]
       [--no_python]
       [--run_path]
       [--log_dir LOG_DIR]
       [-r REDIRECTS]
       [-t TEE]
       [--node_rank NODE_RANK]
       [--master_addr MASTER_ADDR]
       [--master_port MASTER_PORT]
       training_script
       ...
torchrun: error: unrecognized arguments: --rdzv_timeout
usage: torchrun
       [-h]
       [--nnodes NNODES]
       [--nproc_per_node NPROC_PER_NODE]
       [--rdzv_backend RDZV_BACKEND]
       [--rdzv_endpoint RDZV_ENDPOINT]
       [--rdzv_id RDZV_ID]
       [--rdzv_conf RDZV_CONF]
       [--standalone]
       [--max_restarts MAX_RESTARTS]
       [--monitor_interval MONITOR_INTERVAL]
       [--start_method {spawn,fork,forkserver}]
       [--role ROLE]
       [-m]
       [--no_python]
       [--run_path]
       [--log_dir LOG_DIR]
       [-r REDIRECTS]
       [-t TEE]
       [--node_rank NODE_RANK]
       [--master_addr MASTER_ADDR]
       [--master_port MASTER_PORT]
       training_script
       ...
torchrun: error: unrecognized arguments: --rdzv_timeout
usage: torchrun
       [-h]
       [--nnodes NNODES]
       [--nproc_per_node NPROC_PER_NODE]
       [--rdzv_backend RDZV_BACKEND]
       [--rdzv_endpoint RDZV_ENDPOINT]
       [--rdzv_id RDZV_ID]
       [--rdzv_conf RDZV_CONF]
       [--standalone]
       [--max_restarts MAX_RESTARTS]
       [--monitor_interval MONITOR_INTERVAL]
       [--start_method {spawn,fork,forkserver}]
       [--role ROLE]
       [-m]
       [--no_python]
       [--run_path]
       [--log_dir LOG_DIR]
       [-r REDIRECTS]
       [-t TEE]
       [--node_rank NODE_RANK]
       [--master_addr MASTER_ADDR]
       [--master_port MASTER_PORT]
       training_script
       ...
torchrun: error: unrecognized arguments: --rdzv_timeout
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[50568,1],1]
  Exit code:    2
--------------------------------------------------------------------------
/var/spool/slurm/d/job02447/slurm_script: line 26: main.py: command not found
Finished wanda pruning with MPI on a single node
