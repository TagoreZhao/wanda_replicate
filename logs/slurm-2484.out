Running wanda pruning with MPI on a single node with 4 GPUs
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
                backend = Backend(backend)backend = Backend(backend)backend = Backend(backend)backend = Backend(backend)



  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
        raise ValueError("Invalid backend: '{}'".format(name))raise ValueError("Invalid backend: '{}'".format(name))

ValueErrorValueError: : Invalid backend: 'gloo|nccl'Invalid backend: 'gloo|nccl'

    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4036152) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4036165) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4036179) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4036191) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4036203) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 12, in <module>
    dist.init_process_group(backend="gloo|nccl")
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 556, in init_process_group
    backend = Backend(backend)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 123, in __new__
    raise ValueError("Invalid backend: '{}'".format(name))
ValueError: Invalid backend: 'gloo|nccl'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4036216) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
Traceback (most recent call last):
  File "/Users/918839576/miniconda3/envs/prune_llm/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==1.10.1', 'console_scripts', 'torchrun')())
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/run.py", line 719, in main
    run(args)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/run.py", line 710, in run
    elastic_launch(
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 259, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-11-01_16:38:47
  host      : gpu01.hpc.at.sfsu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4036217)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-11-01_16:38:47
  host      : gpu01.hpc.at.sfsu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4036218)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-11-01_16:38:47
  host      : gpu01.hpc.at.sfsu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4036219)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-11-01_16:38:47
  host      : gpu01.hpc.at.sfsu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4036216)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[32932,1],0]
  Exit code:    1
--------------------------------------------------------------------------
Finished wanda pruning with MPI on a single node
