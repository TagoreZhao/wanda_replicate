Running with wanda pruning method
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
torch 1.10.1
torch 1.10.1
torch 1.10.1
transformers 4.46.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.86s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.92s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.04s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.87s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.02s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.04s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.04s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.03s/it]
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
dataset loading complete
dataset loading complete
dataset loading complete
dataset loading complete
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 17 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
nsamples 83
sample 0
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 18 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 19 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 20 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 21 name mlp.down_proj
sample 50
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 22 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 23 name mlp.down_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
wikitext perplexity 7.940742015838623
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
pruning layer 25 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 26 name mlp.down_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 27 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 28 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name mlp.down_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
nsamples 83
sample 0
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name mlp.down_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
************************************************************

layer 0 sparsity 0.500000
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000layer 2 sparsity 0.500000

layer 3 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
nsamples 83
sample 0
sample 50
wikitext perplexity 7.940742015838623
sample 50
sample 50
wikitext perplexity 7.940742015838623
wikitext perplexity 7.940742015838623
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
torch 1.10.1
torch 1.10.1
transformers 4.46.1
transformers 4.46.1torch
 1.10.1
accelerate 1.0.1
# of gpus:  4
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
transformers 4.46.1
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
accelerate 1.0.1
# of gpus:  4
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.92s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.01s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.93s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.95s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.03s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.84s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.01s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.98s/it]
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
dataset loading complete
dataset loading complete
dataset loading complete
dataset loading complete
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 117, in <module>
    main()
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 76, in main
    prune_wanda(args, model, tokenizer, device, prune_n=prune_n, prune_m=prune_m)
  File "/Users/918839576/Trepo/wanda_replicate/lib/prune.py", line 180, in prune_wanda
    inps, outs, attention_mask, position_ids = prepare_calibration_input(model, dataloader, device)
  File "/Users/918839576/Trepo/wanda_replicate/lib/prune.py", line 90, in prepare_calibration_input
    outs = torch.zeros_like(inps)
RuntimeError: CUDA out of memory. Tried to allocate 4.00 GiB (GPU 0; 79.14 GiB total capacity; 6.91 GiB already allocated; 2.56 GiB free; 6.92 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 117, in <module>
    main()
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 76, in main
    prune_wanda(args, model, tokenizer, device, prune_n=prune_n, prune_m=prune_m)
  File "/Users/918839576/Trepo/wanda_replicate/lib/prune.py", line 205, in prune_wanda
    outs[j] = layer(inps[j].unsqueeze(0), attention_mask=attention_mask, position_ids=position_ids)[0]
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 676, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 373, in forward
    attn_weights = nn.functional.softmax(attn_weights, dim=-1, dtype=torch.float32).to(query_states.dtype)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/nn/functional.py", line 1682, in softmax
    ret = input.softmax(dim, dtype=dtype)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 GiB (GPU 0; 79.14 GiB total capacity; 12.04 GiB already allocated; 1.49 GiB free; 12.18 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 117, in <module>
    main()
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 76, in main
    prune_wanda(args, model, tokenizer, device, prune_n=prune_n, prune_m=prune_m)
  File "/Users/918839576/Trepo/wanda_replicate/lib/prune.py", line 205, in prune_wanda
    outs[j] = layer(inps[j].unsqueeze(0), attention_mask=attention_mask, position_ids=position_ids)[0]
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 676, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 366, in forward
    attn_weights = torch.matmul(query_states, key_states.transpose(2, 3)) / math.sqrt(self.head_dim)
RuntimeError: CUDA out of memory. Tried to allocate 1024.00 MiB (GPU 0; 79.14 GiB total capacity; 12.04 GiB already allocated; 441.81 MiB free; 12.18 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 4056571 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4056568) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
torch 1.10.1
torch 1.10.1
loading llm model meta-llama/Llama-2-7b-chat-hf
transformers 4.46.1
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
torch 1.10.1
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.96s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.01s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.19s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.84s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.01s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.84s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.01s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.91s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.10s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.94s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.13s/it]
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
dataset loading complete
dataset loading complete
dataset loading complete
dataset loading complete
Traceback (most recent call last):
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 117, in <module>
    main()
  File "/Users/918839576/Trepo/wanda_replicate/main.py", line 76, in main
    prune_wanda(args, model, tokenizer, device, prune_n=prune_n, prune_m=prune_m)
  File "/Users/918839576/Trepo/wanda_replicate/lib/prune.py", line 180, in prune_wanda
    inps, outs, attention_mask, position_ids = prepare_calibration_input(model, dataloader, device)
  File "/Users/918839576/Trepo/wanda_replicate/lib/prune.py", line 90, in prepare_calibration_input
    outs = torch.zeros_like(inps)
RuntimeError: CUDA out of memory. Tried to allocate 4.00 GiB (GPU 0; 79.14 GiB total capacity; 6.91 GiB already allocated; 3.24 GiB free; 6.92 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 4056750 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 4056751 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 4056752 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 3 (pid: 4056753) of binary: /Users/918839576/miniconda3/envs/prune_llm/bin/python
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
transformers 4.46.1
torch 1.10.1
accelerate 1.0.1
# of gpus:  4
torch 1.10.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
transformers 4.46.1
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
torch 1.10.1
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.98s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.09s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.25s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.23s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.99s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.06s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.16s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.16s/it]
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
dataset loading complete
dataset loading complete
dataset loading complete
dataset loading complete
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name self_attn.q_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name mlp.down_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name mlp.down_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.down_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.down_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.down_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.down_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.down_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.down_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.down_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.down_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.down_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.down_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.down_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.down_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 15 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.down_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 16 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 17 name mlp.down_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 18 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 19 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 20 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 21 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 22 name mlp.down_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 27 name self_attn.q_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.o_proj
pruning layer 27 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 27 name self_attn.v_proj
pruning layer 23 name mlp.gate_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 23 name self_attn.o_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 23 name mlp.down_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 29 name self_attn.q_proj
pruning layer 24 name mlp.down_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 24 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
pruning layer 25 name self_attn.q_proj
layer 28 sparsity 0.500000
pruning layer 25 name self_attn.q_proj
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
pruning layer 25 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 26 name mlp.down_proj
nsamples 83
sample 0
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 27 name mlp.down_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 28 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 29 name mlp.down_proj
sample 50
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 30 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
pruning layer 31 name mlp.down_proj
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
wikitext perplexity 12.43095874786377
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
******************************
******************************
layer 0 sparsity 0.500000
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
sample 50
sample 50
sample 50
wikitext perplexity 12.43095874786377
wikitext perplexity 12.43095874786377
wikitext perplexity 12.43095874786377
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torchtorch  1.10.11.10.1

torch 1.10.1
transformers 4.46.1
transformers 4.46.1
torch 1.10.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
transformers 4.46.1
transformers 4.46.1
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
accelerate 1.0.1
# of gpus:  4
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.91s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.01s/it]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.54s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.76s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.82s/it]use device  cuda:0
pruning starts
loading calibdation data
Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.79s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.79s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.79s/it]
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
use device  cuda:0
pruning starts
loading calibdation data
dataset loading complete
dataset loading complete
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
dataset loading complete
dataset loading complete
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 1 name self_attn.q_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.q_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name self_attn.k_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name self_attn.v_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name self_attn.o_proj
pruning layer 0 name mlp.gate_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.up_proj
pruning layer 0 name mlp.down_proj
pruning layer 0 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.o_proj
pruning layer 2 name self_attn.q_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.q_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name self_attn.k_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name self_attn.v_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name self_attn.o_proj
pruning layer 1 name mlp.gate_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.up_proj
pruning layer 1 name mlp.down_proj
pruning layer 1 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.o_proj
pruning layer 3 name self_attn.q_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.q_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name self_attn.k_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name self_attn.v_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name self_attn.o_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.gate_proj
pruning layer 2 name mlp.down_proj
pruning layer 2 name mlp.up_proj
pruning layer 2 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 4 name self_attn.q_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.q_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name self_attn.k_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name self_attn.v_proj
pruning layer 3 name self_attn.o_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.gate_proj
pruning layer 3 name mlp.down_proj
pruning layer 3 name mlp.up_proj
pruning layer 3 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 5 name self_attn.q_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.q_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name self_attn.k_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name self_attn.v_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name self_attn.o_proj
pruning layer 4 name mlp.gate_proj
pruning layer 4 name mlp.down_proj
pruning layer 4 name mlp.up_proj
pruning layer 4 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 6 name self_attn.q_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.q_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name self_attn.k_proj
pruning layer 5 name self_attn.v_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name self_attn.o_proj
pruning layer 5 name mlp.down_proj
pruning layer 5 name mlp.gate_proj
pruning layer 5 name mlp.up_proj
pruning layer 5 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.q_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name self_attn.k_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name self_attn.v_proj
pruning layer 6 name self_attn.o_proj
pruning layer 6 name mlp.down_proj
pruning layer 6 name mlp.gate_proj
pruning layer 6 name mlp.up_proj
pruning layer 6 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.q_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.k_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.v_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name self_attn.o_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.gate_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.up_proj
pruning layer 7 name mlp.down_proj
pruning layer 7 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.q_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.k_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.v_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name self_attn.o_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.gate_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.up_proj
pruning layer 8 name mlp.down_proj
pruning layer 8 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.q_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.k_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.v_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name self_attn.o_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.gate_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.up_proj
pruning layer 9 name mlp.down_proj
pruning layer 9 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.q_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name self_attn.k_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name self_attn.v_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name self_attn.o_proj
pruning layer 10 name mlp.gate_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.up_proj
pruning layer 10 name mlp.down_proj
pruning layer 10 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.q_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name self_attn.k_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name self_attn.v_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name self_attn.o_proj
pruning layer 11 name mlp.gate_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.up_proj
pruning layer 11 name mlp.down_proj
pruning layer 11 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 12 name self_attn.q_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 12 name self_attn.q_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name self_attn.k_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name self_attn.v_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name self_attn.o_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.gate_proj
pruning layer 12 name mlp.down_proj
pruning layer 12 name mlp.up_proj
pruning layer 12 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 20 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 13 name self_attn.o_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.q_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name self_attn.k_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name self_attn.v_proj
pruning layer 13 name self_attn.o_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.gate_proj
pruning layer 13 name mlp.down_proj
pruning layer 13 name mlp.up_proj
pruning layer 13 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 14 name self_attn.q_proj
pruning layer 14 name self_attn.q_proj
pruning layer 25 name self_attn.q_proj
pruning layer 14 name self_attn.k_proj
pruning layer 14 name self_attn.v_proj
pruning layer 25 name self_attn.k_proj
pruning layer 14 name self_attn.o_proj
pruning layer 25 name self_attn.v_proj
pruning layer 14 name self_attn.k_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 14 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 14 name self_attn.v_proj
pruning layer 25 name mlp.down_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name self_attn.o_proj
pruning layer 14 name mlp.gate_proj
pruning layer 14 name mlp.down_proj
pruning layer 14 name mlp.up_proj
pruning layer 14 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.q_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name self_attn.k_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name self_attn.v_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name self_attn.o_proj
pruning layer 15 name mlp.gate_proj
pruning layer 15 name mlp.down_proj
pruning layer 15 name mlp.up_proj
pruning layer 15 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.q_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.k_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.v_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name self_attn.o_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.gate_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.up_proj
pruning layer 16 name mlp.down_proj
pruning layer 16 name mlp.down_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
nsamples 83
sample 0
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.q_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.k_proj
pruning layer 17 name self_attn.v_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name self_attn.o_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.gate_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.up_proj
pruning layer 17 name mlp.down_proj
pruning layer 17 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.q_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name self_attn.k_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name self_attn.v_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name self_attn.o_proj
pruning layer 18 name mlp.gate_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.up_proj
pruning layer 18 name mlp.down_proj
pruning layer 18 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.q_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name self_attn.k_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name self_attn.v_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name self_attn.o_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.gate_proj
pruning layer 19 name mlp.up_proj
pruning layer 19 name mlp.down_proj
pruning layer 19 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.q_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name self_attn.k_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name self_attn.v_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name self_attn.o_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.gate_proj
pruning layer 20 name mlp.down_proj
pruning layer 20 name mlp.up_proj
pruning layer 20 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
sample 50
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.q_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name self_attn.k_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name self_attn.v_proj
pruning layer 21 name self_attn.o_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.gate_proj
pruning layer 21 name mlp.down_proj
pruning layer 21 name mlp.up_proj
pruning layer 21 name mlp.down_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.q_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name self_attn.k_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name self_attn.v_proj
pruning layer 22 name self_attn.o_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.gate_proj
pruning layer 22 name mlp.down_proj
pruning layer 22 name mlp.up_proj
pruning layer 22 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
wikitext perplexity 9.6143798828125
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.q_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name self_attn.k_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name self_attn.v_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name self_attn.o_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.gate_proj
pruning layer 23 name mlp.down_proj
pruning layer 23 name mlp.up_proj
pruning layer 23 name mlp.down_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.q_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name self_attn.k_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name self_attn.v_proj
pruning layer 24 name self_attn.o_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.gate_proj
pruning layer 24 name mlp.down_proj
pruning layer 24 name mlp.up_proj
pruning layer 24 name mlp.down_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.q_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name self_attn.k_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name self_attn.v_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name self_attn.o_proj
pruning layer 25 name mlp.gate_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.up_proj
pruning layer 25 name mlp.down_proj
pruning layer 25 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.q_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name self_attn.k_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name self_attn.v_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name self_attn.o_proj
pruning layer 26 name mlp.gate_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.up_proj
pruning layer 26 name mlp.down_proj
pruning layer 26 name mlp.down_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.q_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name self_attn.k_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name self_attn.v_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name self_attn.o_proj
pruning layer 27 name mlp.gate_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.up_proj
pruning layer 27 name mlp.down_proj
pruning layer 27 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.q_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name self_attn.k_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name self_attn.v_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name self_attn.o_proj
pruning layer 28 name mlp.gate_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.up_proj
pruning layer 28 name mlp.down_proj
pruning layer 28 name mlp.down_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.q_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name self_attn.k_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name self_attn.v_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name self_attn.o_proj
pruning layer 29 name mlp.gate_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.up_proj
pruning layer 29 name mlp.down_proj
pruning layer 29 name mlp.down_proj
nsamples 83
sample 0
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.q_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name self_attn.k_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name self_attn.v_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name self_attn.o_proj
pruning layer 30 name mlp.gate_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.up_proj
pruning layer 30 name mlp.down_proj
pruning layer 30 name mlp.down_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.q_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.k_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.v_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name self_attn.o_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.gate_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.up_proj
pruning layer 31 name mlp.down_proj
pruning layer 31 name mlp.down_proj
******************************
layer 0 sparsity 0.500000
******************************
layer 1 sparsity 0.500000
layer 0 sparsity 0.500000
layer 2 sparsity 0.500000
layer 1 sparsity 0.500000
layer 3 sparsity 0.500000
layer 2 sparsity 0.500000
layer 4 sparsity 0.500000
layer 3 sparsity 0.500000
layer 5 sparsity 0.500000
layer 4 sparsity 0.500000
layer 6 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000layer 27 sparsity 0.500000

layer 28 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
sample 50
nsamples 83
sample 0
nsamples 83
sample 0
wikitext perplexity 9.6143798828125
sample 50
sample 50
wikitext perplexity 9.6143798828125
wikitext perplexity 9.6143798828125
Finished wanda pruning method
Running with sparsegpt pruning method
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torchtorch  torch1.10.11.10.1torch 

 1.10.11.10.1

transformers 4.46.1
transformers 4.46.1
transformers 4.46.1
transformers 4.46.1
accelerate 1.0.1
accelerate # of gpus: 1.0.1 
4
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.91s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.99s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.10s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.89s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.04s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.07s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.87s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.05s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.04s/it]
use device  cuda:0
pruning starts
Starting ...
use device  cuda:0
pruning starts
Starting ...
use device  cuda:0
pruning starts
Starting ...
use device  cuda:0
pruning starts
Starting ...
Ready.
layer 0 device 0
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Ready.Ready.

layer 0 device 0layer 0 device 0

Ready.
layer 0 device 0
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
0 self_attn.q_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
layer 1 device 0
0 mlp.gate_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 mlp.down_proj
Pruning ...
layer 1 device 0
layer 1 device 0
layer 1 device 0
1 self_attn.q_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
layer 2 device 0
1 self_attn.q_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 mlp.down_proj
Pruning ...
layer 2 device 0
layer 2 device 0
layer 2 device 0
2 self_attn.q_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.down_proj
Pruning ...
layer 3 device 0
2 self_attn.q_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 mlp.down_proj
Pruning ...
layer 3 device 0
layer 3 device 0
layer 3 device 0
3 self_attn.q_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.down_proj
Pruning ...
layer 4 device 0
3 self_attn.q_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 mlp.down_proj
Pruning ...
layer 4 device 0
layer 4 device 0
layer 4 device 0
4 self_attn.q_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.down_proj
Pruning ...
layer 5 device 0
4 self_attn.q_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 mlp.down_proj
Pruning ...
layer 5 device 0
layer 5 device 0
layer 5 device 0
5 self_attn.q_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.down_proj
Pruning ...
layer 6 device 0
5 self_attn.q_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 mlp.down_proj
Pruning ...
layer 6 device 0
layer 6 device 0
layer 6 device 0
6 self_attn.q_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.down_proj
Pruning ...
layer 7 device 1
6 self_attn.q_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.down_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 mlp.up_proj
Pruning ...
layer 8 device 1
6 self_attn.k_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 mlp.down_proj
Pruning ...
layer 7 device 1
8 self_attn.q_proj
Pruning ...
layer 7 device 1
layer 7 device 1
8 self_attn.k_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.down_proj
Pruning ...
layer 9 device 1
7 self_attn.q_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.down_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.down_proj
Pruning ...
7 mlp.down_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
layer 8 device 1
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.down_proj
Pruning ...
layer 8 device 1
layer 8 device 1
layer 10 device 1
8 self_attn.q_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 self_attn.q_proj
Pruning ...
8 self_attn.q_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.down_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.up_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.down_proj
Pruning ...
8 mlp.down_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
layer 9 device 1
10 self_attn.v_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.down_proj
Pruning ...
layer 9 device 1
layer 9 device 1
layer 11 device 1
9 self_attn.q_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.down_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.up_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
9 mlp.down_proj
Pruning ...
9 mlp.down_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
layer 10 device 1
11 self_attn.v_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.down_proj
Pruning ...
layer 10 device 1
layer 10 device 1
layer 12 device 1
10 self_attn.q_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.down_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.up_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
10 mlp.down_proj
Pruning ...
10 mlp.down_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
layer 11 device 1
12 self_attn.v_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 mlp.down_proj
Pruning ...
layer 11 device 1
layer 11 device 1
layer 13 device 1
11 self_attn.q_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.down_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.up_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
11 mlp.down_proj
Pruning ...
11 mlp.down_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
layer 12 device 1
13 self_attn.v_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.down_proj
Pruning ...
layer 12 device 1
layer 12 device 1
layer 14 device 1
12 self_attn.q_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 mlp.down_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 mlp.up_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
12 mlp.down_proj
Pruning ...
12 mlp.down_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
layer 13 device 1
14 self_attn.v_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.down_proj
Pruning ...
layer 13 device 1
layer 13 device 1
layer 15 device 1
13 self_attn.q_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.down_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.up_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
13 mlp.down_proj
Pruning ...
13 mlp.down_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
layer 14 device 1
15 self_attn.v_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.down_proj
Pruning ...
layer 14 device 1
layer 14 device 1
layer 16 device 2
16 self_attn.q_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.down_proj
Pruning ...
layer 17 device 2
14 self_attn.q_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.down_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
layer 18 device 2
14 self_attn.v_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.down_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.down_proj
Pruning ...
layer 15 device 1
18 self_attn.q_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.up_proj
Pruning ...
layer 15 device 1
18 mlp.down_proj
Pruning ...
layer 15 device 1
layer 19 device 2
19 self_attn.q_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.down_proj
Pruning ...
layer 20 device 2
20 self_attn.q_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.down_proj
Pruning ...
layer 21 device 2
15 self_attn.k_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.down_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.down_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.down_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
layer 16 device 2
layer 16 device 2
layer 16 device 2
layer 22 device 2
16 self_attn.q_proj
Pruning ...
22 self_attn.q_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
16 mlp.up_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
16 mlp.down_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.down_proj
Pruning ...
16 mlp.down_proj
Pruning ...
layer 17 device 2
layer 23 device 2
layer 17 device 2
layer 17 device 2
17 self_attn.q_proj
Pruning ...
23 self_attn.q_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
17 mlp.up_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
17 mlp.down_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
17 mlp.down_proj
Pruning ...
layer 18 device 2
layer 24 device 2
layer 18 device 2
layer 18 device 2
18 self_attn.q_proj
Pruning ...
24 self_attn.q_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
18 self_attn.q_proj
Pruning ...
18 mlp.up_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
18 self_attn.q_proj
Pruning ...
18 mlp.down_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.down_proj
Pruning ...
18 mlp.down_proj
Pruning ...
layer 19 device 2
layer 25 device 3
layer 19 device 2
layer 19 device 2
25 self_attn.q_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
layer 26 device 3
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
layer 27 device 3
19 self_attn.q_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 self_attn.q_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 self_attn.q_proj
Pruning ...
19 mlp.down_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
27 mlp.down_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.up_proj
Pruning ...
layer 28 device 3
19 mlp.down_proj
Pruning ...
19 mlp.down_proj
Pruning ...
layer 20 device 2
layer 20 device 2
layer 20 device 2
28 self_attn.q_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
layer 29 device 3
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
layer 30 device 3
20 self_attn.q_proj
Pruning ...
30 self_attn.q_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
30 mlp.down_proj
Pruning ...
20 self_attn.q_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 self_attn.q_proj
Pruning ...
20 mlp.down_proj
Pruning ...
layer 31 device 3
20 self_attn.k_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.down_proj
Pruning ...
20 mlp.down_proj
Pruning ...
layer 21 device 2
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
layer 21 device 2
layer 21 device 2
******************************
layer 0 sparsity 0.500002
layer 1 sparsity 0.500002
layer 2 sparsity 0.500002
layer 3 sparsity 0.500002
layer 4 sparsity 0.500001
layer 5 sparsity 0.500002
layer 6 sparsity 0.500002
layer 7 sparsity 0.500001
layer 8 sparsity 0.500002
layer 9 sparsity 0.500001
layer 10 sparsity 0.500002
layer 11 sparsity 0.500002
layer 12 sparsity 0.500002
layer 13 sparsity 0.500002
layer 14 sparsity 0.500002
layer 15 sparsity 0.500002
layer 16 sparsity 0.500002
layer 17 sparsity 0.500002
layer 18 sparsity 0.500002
layer 19 sparsity 0.500002
layer 20 sparsity 0.500002
layer 21 sparsity 0.500002
layer 22 sparsity 0.500002
layer 23 sparsity 0.500002
layer 24 sparsity 0.500002
layer 25 sparsity 0.500001
layer 26 sparsity 0.500002
layer 27 sparsity 0.500002
layer 28 sparsity 0.500002
layer 29 sparsity 0.500002
layer 30 sparsity 0.500002
layer 31 sparsity 0.500002
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
21 self_attn.q_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
21 mlp.down_proj
Pruning ...
layer 22 device 2
layer 22 device 2
layer 22 device 2
sample 50
22 self_attn.q_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 self_attn.q_proj
Pruning ...
22 self_attn.q_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
22 mlp.down_proj
Pruning ...
layer 23 device 2
layer 23 device 2
layer 23 device 2
wikitext perplexity 7.896021842956543
23 self_attn.q_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 self_attn.q_proj
Pruning ...
23 self_attn.q_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
23 mlp.down_proj
Pruning ...
layer 24 device 2
layer 24 device 2
layer 24 device 2
24 self_attn.q_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 self_attn.q_proj
Pruning ...
24 self_attn.q_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
24 mlp.down_proj
Pruning ...
layer 25 device 3
layer 25 device 3
layer 25 device 3
25 self_attn.q_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
layer 26 device 3
25 self_attn.k_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
25 mlp.down_proj
Pruning ...
layer 26 device 3
layer 26 device 3
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
26 self_attn.q_proj
Pruning ...
26 self_attn.q_proj
Pruning ...
layer 27 device 3
26 self_attn.k_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
26 mlp.down_proj
Pruning ...
layer 27 device 3
layer 27 device 3
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.down_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
layer 28 device 3
27 self_attn.k_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.down_proj
Pruning ...
27 mlp.down_proj
Pruning ...
layer 28 device 3
layer 28 device 3
28 self_attn.q_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
layer 29 device 3
28 self_attn.k_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
28 mlp.down_proj
Pruning ...
layer 29 device 3
layer 29 device 3
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
29 self_attn.q_proj
Pruning ...
29 self_attn.q_proj
Pruning ...
layer 30 device 3
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.down_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
layer 30 device 3
layer 30 device 3
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.down_proj
Pruning ...
30 self_attn.q_proj
Pruning ...
layer 31 device 3
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.down_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.down_proj
Pruning ...
layer 31 device 3
layer 31 device 3
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
31 self_attn.q_proj
Pruning ...
******************************
layer 0 sparsity 0.500002
layer 1 sparsity 0.500002
layer 2 sparsity 0.500002
layer 3 sparsity 0.500002
layer 4 sparsity 0.500001
layer 5 sparsity 0.500002
layer 6 sparsity 0.500002
layer 7 sparsity 0.500001
layer 8 sparsity 0.500002
layer 9 sparsity 0.500001
layer 10 sparsity 0.500002
layer 11 sparsity 0.500002
layer 12 sparsity 0.500002
layer 13 sparsity 0.500002
layer 14 sparsity 0.500002
layer 15 sparsity 0.500002
layer 16 sparsity 0.500002
layer 17 sparsity 0.500002
layer 18 sparsity 0.500002
layer 19 sparsity 0.500002
layer 20 sparsity 0.500002
layer 21 sparsity 0.500002
layer 22 sparsity 0.500002
layer 23 sparsity 0.500002
layer 24 sparsity 0.500002
layer 25 sparsity 0.500001
layer 26 sparsity 0.500002
layer 27 sparsity 0.500002
31 self_attn.q_proj
Pruning ...
layer 28 sparsity 0.500002
layer 29 sparsity 0.500002
layer 30 sparsity 0.500002
layer 31 sparsity 0.500002
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.down_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
******************************
layer 0 sparsity 0.500002
layer 1 sparsity 0.500002
layer 2 sparsity 0.500002
layer 3 sparsity 0.500002
layer 4 sparsity 0.500001
layer 5 sparsity 0.500002
layer 6 sparsity 0.500002
layer 7 sparsity 0.500001
layer 8 sparsity 0.500002
layer 9 sparsity 0.500001
layer 10 sparsity 0.500002
layer 11 sparsity 0.500002
layer 12 sparsity 0.500002
layer 13 sparsity 0.500002
layer 14 sparsity 0.500002
layer 15 sparsity 0.500002
layer 16 sparsity 0.500002
layer 17 sparsity 0.500002
layer 18 sparsity 0.500002
layer 19 sparsity 0.500002
layer 20 sparsity 0.500002
layer 21 sparsity 0.500002
layer 22 sparsity 0.500002
layer 23 sparsity 0.500002
layer 24 sparsity 0.500002
layer 25 sparsity 0.500001
layer 26 sparsity 0.500002
layer 27 sparsity 0.500002
layer 28 sparsity 0.500002
layer 29 sparsity 0.500002
layer 30 sparsity 0.500002
layer 31 sparsity 0.500002
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
******************************
layer 0 sparsity 0.500002
layer 1 sparsity 0.500002
layer 2 sparsity 0.500002
layer 3 sparsity 0.500002
layer 4 sparsity 0.500001
layer 5 sparsity 0.500002
layer 6 sparsity 0.500002
layer 7 sparsity 0.500001
layer 8 sparsity 0.500002
layer 9 sparsity 0.500001
layer 10 sparsity 0.500002
layer 11 sparsity 0.500002
layer 12 sparsity 0.500002
layer 13 sparsity 0.500002
layer 14 sparsity 0.500002
layer 15 sparsity 0.500002
layer 16 sparsity 0.500002
layer 17 sparsity 0.500002
layer 18 sparsity 0.500002
layer 19 sparsity 0.500002
layer 20 sparsity 0.500002
layer 21 sparsity 0.500002
layer 22 sparsity 0.500002
layer 23 sparsity 0.500002
layer 24 sparsity 0.500002
layer 25 sparsity 0.500001
layer 26 sparsity 0.500002
layer 27 sparsity 0.500002
layer 28 sparsity 0.500002
layer 29 sparsity 0.500002
layer 30 sparsity 0.500002
layer 31 sparsity 0.500002
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
sample 50
sample 50
sample 50
wikitext perplexity 7.896021842956543
wikitext perplexity 7.896021842956543
wikitext perplexity 7.896021842956543
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
torch 1.10.1
torch 1.10.1
transformers 4.46.1
transformers transformers4.46.1 
4.46.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
torch 1.10.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.74s/it]
Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.89s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.86s/it]use device  cuda:0
pruning starts
Starting ...
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.88s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.79s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.95s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.79s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.95s/it]
use device  cuda:0
pruning starts
Starting ...
use device  cuda:0
pruning starts
Starting ...
use device  cuda:0
pruning starts
Starting ...
Ready.
layer 0 device 0
Ready.
layer 0 device 0
Ready.
layer 0 device 0
Ready.
layer 0 device 0
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
0 self_attn.q_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 mlp.down_proj
Pruning ...
layer 1 device 0
layer 1 device 0
layer 1 device 0
layer 1 device 0
1 self_attn.q_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 mlp.down_proj
Pruning ...
layer 2 device 0
layer 2 device 0
layer 2 device 0
layer 2 device 0
2 self_attn.q_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 mlp.down_proj
Pruning ...
layer 3 device 0
layer 3 device 0
layer 3 device 0
layer 3 device 0
3 self_attn.q_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 mlp.down_proj
Pruning ...
layer 4 device 0
layer 4 device 0
layer 4 device 0
layer 4 device 0
4 self_attn.q_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 mlp.down_proj
Pruning ...
layer 5 device 0
layer 5 device 0
layer 5 device 0
layer 5 device 0
5 self_attn.q_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 mlp.down_proj
Pruning ...
layer 6 device 0
layer 6 device 0
layer 6 device 0
layer 6 device 0
6 self_attn.q_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 mlp.down_proj
Pruning ...
layer 7 device 1
layer 7 device 1
layer 7 device 1
layer 7 device 1
7 self_attn.q_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 mlp.down_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.down_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.down_proj
Pruning ...
7 mlp.down_proj
Pruning ...
layer 8 device 1
layer 8 device 1
layer 8 device 1
layer 8 device 1
8 self_attn.q_proj
Pruning ...
8 self_attn.q_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.q_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 self_attn.q_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 mlp.down_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.down_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.down_proj
Pruning ...
8 mlp.down_proj
Pruning ...
layer 9 device 1
layer 9 device 1
layer 9 device 1
layer 9 device 1
9 self_attn.q_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 mlp.down_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.down_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.down_proj
Pruning ...
9 mlp.down_proj
Pruning ...
layer 10 device 1
layer 10 device 1
layer 10 device 1
layer 10 device 1
10 self_attn.q_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 mlp.down_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.down_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.down_proj
Pruning ...
10 mlp.down_proj
Pruning ...
layer 11 device 1
layer 11 device 1
layer 11 device 1
layer 11 device 1
11 self_attn.q_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
11 mlp.down_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.down_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.down_proj
Pruning ...
11 mlp.down_proj
Pruning ...
layer 12 device 1
layer 12 device 1
layer 12 device 1
layer 12 device 1
12 self_attn.q_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
12 mlp.down_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 mlp.down_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 mlp.down_proj
Pruning ...
12 mlp.down_proj
Pruning ...
layer 13 device 1
layer 13 device 1
layer 13 device 1
layer 13 device 1
13 self_attn.q_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
13 mlp.down_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.down_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.down_proj
Pruning ...
13 mlp.down_proj
Pruning ...
layer 14 device 1
layer 14 device 1
layer 14 device 1
layer 14 device 1
14 self_attn.q_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
14 mlp.down_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.down_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.down_proj
Pruning ...
14 mlp.down_proj
Pruning ...
layer 15 device 1
layer 15 device 1
layer 15 device 1
layer 15 device 1
15 self_attn.q_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
15 mlp.down_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.down_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.down_proj
Pruning ...
15 mlp.down_proj
Pruning ...
layer 16 device 2
layer 16 device 2
layer 16 device 2
layer 16 device 2
16 self_attn.q_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.down_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
layer 17 device 2
16 mlp.up_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
16 mlp.down_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.down_proj
Pruning ...
layer 17 device 2
16 mlp.down_proj
Pruning ...
layer 17 device 2
layer 17 device 2
17 self_attn.q_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
layer 18 device 2
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
17 mlp.down_proj
Pruning ...
layer 18 device 2
layer 18 device 2
layer 18 device 2
18 self_attn.q_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.down_proj
Pruning ...
18 self_attn.q_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
layer 19 device 2
18 mlp.up_proj
Pruning ...
18 mlp.down_proj
Pruning ...
18 self_attn.q_proj
Pruning ...
18 self_attn.q_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.down_proj
Pruning ...
18 mlp.down_proj
Pruning ...
layer 19 device 2
layer 19 device 2
layer 19 device 2
19 self_attn.q_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.down_proj
Pruning ...
19 self_attn.q_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
layer 20 device 2
19 mlp.down_proj
Pruning ...
19 self_attn.q_proj
Pruning ...
19 self_attn.q_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.down_proj
Pruning ...
layer 20 device 2
19 mlp.down_proj
Pruning ...
layer 20 device 2
layer 20 device 2
20 self_attn.q_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.down_proj
Pruning ...
20 self_attn.q_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
layer 21 device 2
20 mlp.down_proj
Pruning ...
20 self_attn.q_proj
Pruning ...
20 self_attn.q_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.down_proj
Pruning ...
layer 21 device 2
20 mlp.down_proj
Pruning ...
layer 21 device 2
layer 21 device 2
21 self_attn.q_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
layer 22 device 2
21 mlp.down_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
layer 22 device 2
21 mlp.down_proj
Pruning ...
layer 22 device 2
layer 22 device 2
22 self_attn.q_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
22 self_attn.q_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
layer 23 device 2
22 self_attn.q_proj
Pruning ...
22 self_attn.q_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
layer 23 device 2
22 mlp.down_proj
Pruning ...
layer 23 device 2
layer 23 device 2
23 self_attn.q_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
23 self_attn.q_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
layer 24 device 2
23 self_attn.q_proj
Pruning ...
23 self_attn.q_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
layer 24 device 2
23 mlp.down_proj
Pruning ...
layer 24 device 2
layer 24 device 2
24 self_attn.q_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
24 self_attn.q_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
layer 25 device 3
24 self_attn.q_proj
Pruning ...
24 self_attn.q_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
layer 25 device 3
24 mlp.down_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
layer 25 device 3
layer 25 device 3
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
layer 26 device 3
25 self_attn.q_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.up_proj
Pruning ...
layer 26 device 3
25 mlp.down_proj
Pruning ...
25 mlp.down_proj
Pruning ...
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
layer 26 device 3
layer 26 device 3
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
layer 27 device 3
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
26 self_attn.q_proj
Pruning ...
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.up_proj
Pruning ...
layer 27 device 3
26 mlp.down_proj
Pruning ...
26 mlp.down_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
layer 27 device 3
layer 27 device 3
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.down_proj
Pruning ...
layer 28 device 3
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.down_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.up_proj
Pruning ...
layer 28 device 3
27 mlp.down_proj
Pruning ...
27 mlp.down_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
layer 28 device 3
28 self_attn.o_proj
Pruning ...
layer 28 device 3
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
layer 29 device 3
28 self_attn.q_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.up_proj
Pruning ...
layer 29 device 3
28 mlp.down_proj
Pruning ...
28 mlp.down_proj
Pruning ...
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
layer 29 device 3
29 self_attn.o_proj
Pruning ...
layer 29 device 3
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
layer 30 device 3
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
29 self_attn.q_proj
Pruning ...
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.up_proj
Pruning ...
layer 30 device 3
29 mlp.down_proj
Pruning ...
29 mlp.down_proj
Pruning ...
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
layer 30 device 3
layer 30 device 3
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.down_proj
Pruning ...
layer 31 device 3
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.down_proj
Pruning ...
30 self_attn.q_proj
Pruning ...
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.up_proj
Pruning ...
layer 31 device 3
30 mlp.down_proj
Pruning ...
30 mlp.down_proj
Pruning ...
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
layer 31 device 3
layer 31 device 3
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
nsamples 83
sample 0
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
31 self_attn.q_proj
Pruning ...
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.up_proj
Pruning ...
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
31 mlp.down_proj
Pruning ...
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
31 mlp.down_proj
Pruning ...
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
******************************
layer 15 sparsity 0.500000
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 16 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 17 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 18 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 19 sparsity 0.500000
layer 16 sparsity 0.500000
layer 20 sparsity 0.500000
layer 17 sparsity 0.500000
layer 21 sparsity 0.500000
layer 18 sparsity 0.500000
layer 22 sparsity 0.500000
layer 19 sparsity 0.500000
layer 23 sparsity 0.500000
layer 20 sparsity 0.500000
layer 24 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
sample 50
nsamples 83
sample 0
nsamples 83
sample 0
wikitext perplexity 10.84209156036377
sample 50
sample 50
sample 50
wikitext perplexity 10.84209156036377
wikitext perplexity 10.84209156036377
wikitext perplexity 10.84209156036377
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
torch 1.10.1
transformers 4.46.1
torch 1.10.1
torch 1.10.1
accelerate 1.0.1
# of gpus:  4
transformers 4.46.1
transformers 4.46.1
transformers 4.46.1
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
accelerate 1.0.1
accelerate 1.0.1
# of gpus:  4
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.56s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.90s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.01s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  3.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.94s/it]
use device  cuda:0
pruning starts
Starting ...
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.84s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.02s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.02s/it]
use device  cuda:0
pruning starts
Starting ...
use device  cuda:0
pruning starts
Starting ...
use device  cuda:0
pruning starts
Starting ...
Ready.
layer 0 device 0
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Ready.
layer 0 device 0
Ready.
layer 0 device 0
Ready.
layer 0 device 0
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
0 self_attn.q_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 self_attn.q_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.k_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.v_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 self_attn.o_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.gate_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.up_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 mlp.down_proj
Pruning ...
0 mlp.down_proj
Pruning ...
layer 1 device 0
layer 1 device 0
layer 1 device 0
layer 1 device 0
1 self_attn.q_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
1 self_attn.q_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.k_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.v_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 self_attn.o_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.gate_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.up_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 mlp.down_proj
Pruning ...
1 mlp.down_proj
Pruning ...
layer 2 device 0
layer 2 device 0
layer 2 device 0
layer 2 device 0
2 self_attn.q_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 self_attn.q_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.k_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.v_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 self_attn.o_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.gate_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.up_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 mlp.down_proj
Pruning ...
2 mlp.down_proj
Pruning ...
layer 3 device 0
layer 3 device 0
layer 3 device 0
layer 3 device 0
3 self_attn.q_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 self_attn.q_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.k_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.v_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 self_attn.o_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.gate_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.up_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 mlp.down_proj
Pruning ...
3 mlp.down_proj
Pruning ...
layer 4 device 0
layer 4 device 0
layer 4 device 0
layer 4 device 0
4 self_attn.q_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 self_attn.q_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.k_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 self_attn.v_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 self_attn.o_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.gate_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.up_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 mlp.down_proj
Pruning ...
4 mlp.down_proj
Pruning ...
layer 5 device 0
layer 5 device 0
layer 5 device 0
layer 5 device 0
5 self_attn.q_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 self_attn.q_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.k_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 self_attn.v_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 self_attn.o_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.gate_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 mlp.up_proj
Pruning ...
5 mlp.down_proj
Pruning ...
5 mlp.down_proj
Pruning ...
layer 6 device 0
layer 6 device 0
layer 6 device 0
layer 6 device 0
6 self_attn.q_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
6 self_attn.q_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.k_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 self_attn.v_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 self_attn.o_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.gate_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 mlp.up_proj
Pruning ...
6 mlp.down_proj
Pruning ...
6 mlp.down_proj
Pruning ...
layer 7 device 1
layer 7 device 1
layer 7 device 1
layer 7 device 1
7 self_attn.q_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.down_proj
Pruning ...
layer 8 device 1
7 self_attn.q_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.q_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 self_attn.k_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 self_attn.v_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 self_attn.o_proj
Pruning ...
7 mlp.down_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.gate_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.up_proj
Pruning ...
7 mlp.down_proj
Pruning ...
7 mlp.down_proj
Pruning ...
layer 8 device 1
layer 8 device 1
layer 8 device 1
8 self_attn.q_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.down_proj
Pruning ...
layer 9 device 1
8 self_attn.q_proj
Pruning ...
8 self_attn.q_proj
Pruning ...
8 self_attn.q_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 self_attn.k_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 self_attn.v_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 self_attn.o_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.down_proj
Pruning ...
8 mlp.gate_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.up_proj
Pruning ...
8 mlp.down_proj
Pruning ...
8 mlp.down_proj
Pruning ...
layer 9 device 1
layer 9 device 1
layer 9 device 1
9 self_attn.q_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.down_proj
Pruning ...
layer 10 device 1
9 self_attn.q_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
9 self_attn.q_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 self_attn.k_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.v_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 self_attn.o_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.down_proj
Pruning ...
9 mlp.gate_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.up_proj
Pruning ...
9 mlp.down_proj
Pruning ...
9 mlp.down_proj
Pruning ...
layer 10 device 1
layer 10 device 1
layer 10 device 1
10 self_attn.q_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.down_proj
Pruning ...
layer 11 device 1
10 self_attn.q_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
10 self_attn.q_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 self_attn.k_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.v_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 self_attn.o_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.down_proj
Pruning ...
10 mlp.gate_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.up_proj
Pruning ...
10 mlp.down_proj
Pruning ...
10 mlp.down_proj
Pruning ...
layer 11 device 1
layer 11 device 1
layer 11 device 1
11 self_attn.q_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.down_proj
Pruning ...
layer 12 device 1
11 self_attn.q_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
11 self_attn.q_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 self_attn.k_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 self_attn.v_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 self_attn.o_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.down_proj
Pruning ...
11 mlp.gate_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.up_proj
Pruning ...
11 mlp.down_proj
Pruning ...
11 mlp.down_proj
Pruning ...
layer 12 device 1
layer 12 device 1
layer 12 device 1
12 self_attn.q_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.up_proj
Pruning ...
12 mlp.down_proj
Pruning ...
layer 13 device 1
12 self_attn.q_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
12 self_attn.q_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.v_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.k_proj
Pruning ...
12 self_attn.v_proj
12Pruning ...
 self_attn.v_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 self_attn.o_proj
Pruning ...
12 mlp.gate_proj
12Pruning ...
 self_attn.o_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.gate_proj
Pruning ...
12 mlp.up_proj
Pruning ...
1212  mlp.down_projmlp.up_proj

Pruning ...Pruning ...

12 mlp.up_proj
Pruning ...
12 mlp.down_proj
Pruning ...
12 mlp.down_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
layer 13 device 1
13 self_attn.k_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
layer 13 device 1
layer 13 device 1
13 self_attn.o_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.down_proj
Pruning ...
layer 14 device 1
13 self_attn.q_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
13 self_attn.q_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.k_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 self_attn.v_proj
Pruning ...
13 mlp.down_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 self_attn.o_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.gate_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.up_proj
Pruning ...
13 mlp.down_proj
Pruning ...
13 mlp.down_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
layer 14 device 1
layer 14 device 1
layer 14 device 1
14 self_attn.k_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.down_proj
Pruning ...
layer 15 device 1
14 self_attn.q_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
14 self_attn.q_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 self_attn.k_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 self_attn.v_proj
Pruning ...
14 mlp.down_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 self_attn.o_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.gate_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.up_proj
Pruning ...
14 mlp.down_proj
Pruning ...
14 mlp.down_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
layer 15 device 1
layer 15 device 1
layer 15 device 1
15 self_attn.k_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.down_proj
Pruning ...
layer 16 device 2
16 self_attn.q_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.down_proj
Pruning ...
layer 17 device 2
15 self_attn.q_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
15 self_attn.q_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 self_attn.k_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 self_attn.v_proj
Pruning ...
15 mlp.down_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
15 self_attn.o_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
15 mlp.gate_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
15 mlp.up_proj
Pruning ...
15 mlp.up_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
15 mlp.down_proj
Pruning ...
15 mlp.down_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
layer 18 device 2
layer 16 device 2
layer 16 device 2
layer 16 device 2
18 self_attn.q_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.down_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
layer 19 device 2
16 self_attn.k_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
16 self_attn.q_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.down_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.k_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.v_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 self_attn.o_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.gate_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.up_proj
Pruning ...
16 mlp.down_proj
Pruning ...
16 mlp.down_proj
Pruning ...
layer 17 device 2
layer 17 device 2
layer 17 device 2
19 self_attn.q_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.down_proj
Pruning ...
layer 20 device 2
17 self_attn.q_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
17 self_attn.q_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.k_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.v_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 self_attn.o_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.gate_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.up_proj
Pruning ...
17 mlp.down_proj
Pruning ...
17 mlp.down_proj
Pruning ...
layer 18 device 2
layer 18 device 2
layer 18 device 2
20 self_attn.q_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.down_proj
Pruning ...
layer 21 device 2
18 self_attn.q_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 self_attn.q_proj
Pruning ...
18 self_attn.q_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.down_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.k_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.v_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 self_attn.o_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.gate_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.up_proj
Pruning ...
18 mlp.down_proj
Pruning ...
18 mlp.down_proj
Pruning ...
layer 19 device 2
layer 19 device 2
layer 19 device 2
21 self_attn.q_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
layer 22 device 2
19 self_attn.q_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.q_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 self_attn.q_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.down_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.k_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.v_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 self_attn.o_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.gate_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.up_proj
Pruning ...
19 mlp.down_proj
Pruning ...
19 mlp.down_proj
Pruning ...
layer 20 device 2
layer 20 device 2
layer 20 device 2
22 self_attn.q_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
layer 23 device 2
20 self_attn.q_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.q_proj
Pruning ...
20 self_attn.q_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.down_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.k_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.v_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 self_attn.o_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.gate_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.up_proj
Pruning ...
20 mlp.down_proj
Pruning ...
20 mlp.down_proj
Pruning ...
layer 21 device 2
layer 21 device 2
layer 21 device 2
23 self_attn.q_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
layer 24 device 2
21 self_attn.q_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 self_attn.q_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.k_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.v_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 self_attn.o_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.gate_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.up_proj
Pruning ...
21 mlp.down_proj
Pruning ...
21 mlp.down_proj
Pruning ...
layer 22 device 2
layer 22 device 2
layer 22 device 2
24 self_attn.q_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
layer 25 device 3
22 self_attn.q_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.q_proj
Pruning ...
22 self_attn.q_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.down_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
22 self_attn.k_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.v_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
22 self_attn.o_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
22 mlp.gate_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
22 mlp.up_proj
Pruning ...
22 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
22 mlp.down_proj
Pruning ...
22 mlp.down_proj
Pruning ...
layer 26 device 3
layer 23 device 2
layer 23 device 2
layer 23 device 2
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
layer 27 device 3
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.down_proj
Pruning ...
layer 28 device 3
23 self_attn.q_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.q_proj
Pruning ...
23 self_attn.q_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
23 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
23 mlp.down_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.k_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
23 self_attn.v_proj
Pruning ...
layer 29 device 3
23 self_attn.o_proj
Pruning ...
23 self_attn.o_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.gate_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.up_proj
Pruning ...
23 mlp.down_proj
Pruning ...
23 mlp.down_proj
Pruning ...
layer 24 device 2
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
layer 24 device 2
layer 24 device 2
29 self_attn.o_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
layer 30 device 3
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.down_proj
Pruning ...
layer 31 device 3
24 self_attn.q_proj
Pruning ...
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.q_proj
Pruning ...
24 self_attn.q_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
24 mlp.gate_proj
Pruning ...
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.k_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.v_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 self_attn.o_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.gate_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.up_proj
Pruning ...
24 mlp.down_proj
Pruning ...
24 mlp.down_proj
Pruning ...
layer 25 device 3
layer 25 device 3
layer 25 device 3
nsamples 83
sample 0
25 self_attn.q_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
25 self_attn.q_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.k_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
25 self_attn.v_proj
Pruning ...
layer 26 device 3
25 self_attn.o_proj
Pruning ...
25 self_attn.o_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.gate_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.up_proj
Pruning ...
25 mlp.down_proj
Pruning ...
25 mlp.down_proj
Pruning ...
sample 50
layer 26 device 3
layer 26 device 3
wikitext perplexity 8.900956153869629
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
26 self_attn.q_proj
Pruning ...
26 self_attn.q_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.k_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
26 self_attn.v_proj
Pruning ...
layer 27 device 3
26 self_attn.o_proj
Pruning ...
26 self_attn.o_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.gate_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.up_proj
Pruning ...
26 mlp.down_proj
Pruning ...
26 mlp.down_proj
Pruning ...
layer 27 device 3
layer 27 device 3
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.down_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
27 self_attn.q_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.k_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
27 self_attn.v_proj
Pruning ...
layer 28 device 3
27 self_attn.o_proj
Pruning ...
27 self_attn.o_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.gate_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.up_proj
Pruning ...
27 mlp.down_proj
Pruning ...
27 mlp.down_proj
Pruning ...
layer 28 device 3
layer 28 device 3
28 self_attn.q_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
28 self_attn.q_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.k_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
28 self_attn.v_proj
Pruning ...
layer 29 device 3
28 self_attn.o_proj
Pruning ...
28 self_attn.o_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.gate_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.up_proj
Pruning ...
28 mlp.down_proj
Pruning ...
28 mlp.down_proj
Pruning ...
layer 29 device 3
layer 29 device 3
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
29 self_attn.q_proj
Pruning ...
29 self_attn.q_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.k_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
29 self_attn.v_proj
Pruning ...
layer 30 device 3
29 self_attn.o_proj
Pruning ...
29 self_attn.o_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.gate_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.up_proj
Pruning ...
29 mlp.down_proj
Pruning ...
29 mlp.down_proj
Pruning ...
layer 30 device 3
layer 30 device 3
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.down_proj
Pruning ...
30 self_attn.q_proj
Pruning ...
30 self_attn.q_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.k_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
30 self_attn.v_proj
Pruning ...
layer 31 device 3
30 self_attn.o_proj
Pruning ...
30 self_attn.o_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.gate_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.up_proj
Pruning ...
30 mlp.down_proj
Pruning ...
30 mlp.down_proj
Pruning ...
layer 31 device 3
layer 31 device 3
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
31 self_attn.q_proj
Pruning ...
31 self_attn.q_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.k_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.v_proj
Pruning ...
31 self_attn.o_proj
Pruning ...
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
31 self_attn.o_proj
Pruning ...
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
31 mlp.gate_proj
Pruning ...
31 mlp.gate_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.up_proj
Pruning ...
31 mlp.down_proj
Pruning ...
31 mlp.down_proj
Pruning ...
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
******************************
layer 27 sparsity 0.500000
layer 0 sparsity 0.500000
layer 28 sparsity 0.500000
layer 1 sparsity 0.500000
layer 29 sparsity 0.500000
layer 2 sparsity 0.500000
layer 30 sparsity 0.500000
layer 3 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
sample 50
sample 50
sample 50
wikitext perplexity 8.900956153869629
wikitext perplexity 8.900956153869629
wikitext perplexity 8.900956153869629
Finished sparsegpt pruning method
Running with magnitude pruning method
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
torch 1.10.1
transformers 4.46.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
torch 1.10.1
torch 1.10.1
transformers 4.46.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.73s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.77s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.91s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.69s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.85s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.88s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.97s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.96s/it]
use device  cuda:0
pruning starts
use device  cuda:0
pruning starts
use device  cuda:0
pruning starts
use device  cuda:0
pruning starts
******************************
layer 0 sparsity 0.501281
layer 1 sparsity 0.501664
******************************
layer 2 sparsity 0.501208
layer 0 sparsity 0.501281
layer 3 sparsity 0.501076
layer 1 sparsity 0.501664
layer 4 sparsity 0.501001
layer 2 sparsity 0.501208
layer 5 sparsity 0.501267
layer 3 sparsity 0.501076
******************************
layer 6 sparsity 0.501645
layer 7 sparsity 0.500833
layer 8 sparsity 0.500933
layer 4 sparsity 0.501001
layer 9 sparsity 0.501320
layer 0 sparsity 0.501281
layer 10 sparsity 0.501635
layer 11 sparsity 0.500920
******************************
layer 12 sparsity 0.501249
layer 5 sparsity 0.501267
layer 13 sparsity 0.500778
layer 14 sparsity 0.500943
layer 1 sparsity 0.501664
layer 15 sparsity 0.500708
layer 0 sparsity 0.501281
layer 16 sparsity 0.501211
layer 6 sparsity 0.501645
layer 17 sparsity 0.500961
layer 2 sparsity 0.501208
layer 7 sparsity 0.500833
layer 18 sparsity 0.501173
layer 1 sparsity 0.501664
layer 8 sparsity 0.500933
layer 19 sparsity 0.501127
layer 3 sparsity 0.501076
layer 9 sparsity 0.501320
layer 20 sparsity 0.501151
layer 10 sparsity 0.501635
layer 2 sparsity 0.501208
layer 21 sparsity 0.501252
layer 11 sparsity 0.500920
layer 22 sparsity 0.500932
layer 4 sparsity 0.501001
layer 12 sparsity 0.501249
layer 23 sparsity 0.501098
layer 3 sparsity 0.501076
layer 13 sparsity 0.500778
layer 24 sparsity 0.501166
layer 14 sparsity 0.500943
layer 5 sparsity 0.501267
layer 25 sparsity 0.501158
layer 15 sparsity 0.500708
layer 4 sparsity 0.501001
layer 26 sparsity 0.501185
layer 16 sparsity 0.501211
layer 6 sparsity 0.501645
layer 27 sparsity 0.501143
layer 5 sparsity 0.501267
layer 17 sparsity 0.500961
layer 28 sparsity 0.500774
layer 7 sparsity 0.500833
layer 6 sparsity 0.501645
layer 18 sparsity 0.501173
layer 29 sparsity 0.500768
layer 8 sparsity 0.500933
layer 19 sparsity 0.501127
layer 30 sparsity 0.501136
layer 20 sparsity 0.501151
layer 31 sparsity 0.501213
sparsity sanity check 0.5011
******************************
evaluating on wikitext2
layer 7 sparsity 0.500833
layer 21 sparsity 0.501252
layer 9 sparsity 0.501320
layer 22 sparsity 0.500932
layer 23 sparsity 0.501098
layer 8 sparsity 0.500933
layer 10 sparsity 0.501635
layer 24 sparsity 0.501166
layer 25 sparsity 0.501158
layer 9 sparsity 0.501320
layer 26 sparsity 0.501185
layer 11 sparsity 0.500920
layer 27 sparsity 0.501143
layer 10 sparsity 0.501635
layer 28 sparsity 0.500774
layer 12 sparsity 0.501249
layer 29 sparsity 0.500768
layer 30 sparsity 0.501136
layer 11 sparsity 0.500920
layer 31 sparsity 0.501213
sparsity sanity check 0.5011
******************************
evaluating on wikitext2
layer 13 sparsity 0.500778
layer 12 sparsity 0.501249
layer 14 sparsity 0.500943
layer 13 sparsity 0.500778
layer 15 sparsity 0.500708
layer 14 sparsity 0.500943
layer 16 sparsity 0.501211
layer 15 sparsity 0.500708
layer 17 sparsity 0.500961
layer 16 sparsity 0.501211
layer 18 sparsity 0.501173
layer 17 sparsity 0.500961
layer 19 sparsity 0.501127
layer 18 sparsity 0.501173
layer 20 sparsity 0.501151
layer 19 sparsity 0.501127
layer 21 sparsity 0.501252
layer 20 sparsity 0.501151
layer 22 sparsity 0.500932
layer 21 sparsity 0.501252
layer 23 sparsity 0.501098
layer 22 sparsity 0.500932
layer 24 sparsity 0.501166
layer 23 sparsity 0.501098
layer 24 sparsity 0.501166
layer 25 sparsity 0.501158
layer 25 sparsity 0.501158
layer 26 sparsity 0.501185
layer 26 sparsity 0.501185
layer 27 sparsity 0.501143
layer 27 sparsity 0.501143
layer 28 sparsity 0.500774
layer 28 sparsity 0.500774
layer 29 sparsity 0.500768
layer 29 sparsity 0.500768
layer 30 sparsity 0.501136
layer 30 sparsity 0.501136
layer 31 sparsity 0.501213
sparsity sanity check 0.5011
******************************
evaluating on wikitext2
layer 31 sparsity 0.501213
sparsity sanity check 0.5011
******************************
evaluating on wikitext2
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
sample 50
sample 50
sample 50
sample 50
wikitext perplexity 19.078004837036133
wikitext perplexity 19.078004837036133
wikitext perplexity 19.078004837036133
wikitext perplexity 19.078004837036133
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
torch 1.10.1
torch 1.10.1
transformers 4.46.1
transformers 4.46.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
torch 1.10.1
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.53s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.70s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.71s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]
Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.79s/it]use device  cuda:0
pruning starts
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.88s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.88s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.91s/it]
use device  cuda:0
pruning starts
use device  cuda:0
pruning starts
use device  cuda:0
pruning starts
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
******************************
******************************
layer 26 sparsity 0.500000
layer 0 sparsity 0.500000
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 1 sparsity 0.500000
layer 27 sparsity 0.500000
layer 2 sparsity 0.500000
layer 28 sparsity 0.500000
layer 2 sparsity 0.500000
layer 29 sparsity 0.500000
layer 3 sparsity 0.500000
layer 30 sparsity 0.500000
layer 3 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 4 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
sample 50
sample 50
sample 50
sample 50
wikitext perplexity 78.29107666015625
wikitext perplexity 78.29107666015625
wikitext perplexity 78.29107666015625
wikitext perplexity 78.29107666015625
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
torch 1.10.1
torch 1.10.1
torch 1.10.1
transformers 4.46.1
transformers 4.46.1
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
accelerateaccelerate  1.0.11.0.1

# of gpus:  # of gpus: 4 
4
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
loading llm model meta-llama/Llama-2-7b-chat-hf
torch 1.10.1
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
transformers 4.46.1
accelerate 1.0.1
# of gpus:  4
loading llm model meta-llama/Llama-2-7b-chat-hf
/Users/918839576/miniconda3/envs/prune_llm/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py:471: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.65s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.91s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.06s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.82s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.93s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.04s/it]
use device  cuda:0
pruning starts
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.06s/it]
use device  cuda:0
pruning starts
use device  cuda:0
pruning starts
use device  cuda:0
pruning starts
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
layer 6 sparsity 0.500000
layer 7 sparsity 0.500000
layer 8 sparsity 0.500000
layer 9 sparsity 0.500000
layer 10 sparsity 0.500000
layer 11 sparsity 0.500000
layer 12 sparsity 0.500000
layer 13 sparsity 0.500000
layer 14 sparsity 0.500000
layer 15 sparsity 0.500000
layer 16 sparsity 0.500000
layer 17 sparsity 0.500000
layer 18 sparsity 0.500000
layer 19 sparsity 0.500000
layer 20 sparsity 0.500000
layer 21 sparsity 0.500000
layer 22 sparsity 0.500000
layer 23 sparsity 0.500000
layer 24 sparsity 0.500000
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
******************************
layer 0 sparsity 0.500000
layer 1 sparsity 0.500000
layer 2 sparsity 0.500000
layer 3 sparsity 0.500000
layer 4 sparsity 0.500000
layer 5 sparsity 0.500000
******************************
layer 6 sparsity 0.500000
layer 0 sparsity 0.500000
layer 7 sparsity 0.500000
layer 1 sparsity 0.500000
layer 8 sparsity 0.500000
layer 2 sparsity 0.500000
layer 9 sparsity 0.500000
layer 3 sparsity 0.500000
layer 10 sparsity 0.500000
layer 4 sparsity 0.500000
layer 11 sparsity 0.500000
layer 5 sparsity 0.500000
layer 12 sparsity 0.500000
layer 6 sparsity 0.500000
layer 13 sparsity 0.500000
layer 7 sparsity 0.500000
layer 14 sparsity 0.500000
layer 8 sparsity 0.500000
layer 15 sparsity 0.500000
layer 9 sparsity 0.500000
layer 16 sparsity 0.500000
layer 10 sparsity 0.500000
layer 17 sparsity 0.500000
layer 11 sparsity 0.500000
layer 18 sparsity 0.500000
layer 12 sparsity 0.500000
layer 19 sparsity 0.500000
layer 13 sparsity 0.500000
layer 20 sparsity 0.500000
layer 14 sparsity 0.500000
layer 21 sparsity 0.500000
layer 15 sparsity 0.500000
layer 22 sparsity 0.500000
layer 16 sparsity 0.500000
layer 23 sparsity 0.500000
layer 17 sparsity 0.500000
layer 24 sparsity 0.500000
layer 18 sparsity 0.500000
layer 25 sparsity 0.500000
layer 19 sparsity 0.500000
layer 26 sparsity 0.500000
layer 20 sparsity 0.500000
layer 27 sparsity 0.500000
layer 21 sparsity 0.500000
layer 28 sparsity 0.500000
layer 22 sparsity 0.500000
layer 29 sparsity 0.500000
layer 23 sparsity 0.500000
layer 30 sparsity 0.500000
layer 24 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
layer 25 sparsity 0.500000
layer 26 sparsity 0.500000
layer 27 sparsity 0.500000
layer 28 sparsity 0.500000
layer 29 sparsity 0.500000
layer 30 sparsity 0.500000
layer 31 sparsity 0.500000
sparsity sanity check 0.5000
******************************
evaluating on wikitext2
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
nsamples 83
sample 0
sample 50
sample 50
sample 50
sample 50
wikitext perplexity 23.357820510864258
wikitext perplexity 23.357820510864258
wikitext perplexity 23.357820510864258
wikitext perplexity 23.357820510864258
Finished magnitude pruning method
